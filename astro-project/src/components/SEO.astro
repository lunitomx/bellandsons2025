---
interface Props {
  type: 'article' | 'website' | 'localbusiness';
  article?: {
    title: string;
    description: string;
    image: string;
    pubDate: Date;
    author: string;
    url: string;
  };
}

const { type, article } = Astro.props;

const organization = {
  "@type": "Organization",
  "@id": "https://bellandsons.com.mx/#organization",
  "name": "Bell & Sons",
  "url": "https://bellandsons.com.mx",
  "logo": {
    "@type": "ImageObject",
    "url": "https://bellandsons.com.mx/proyectos/xqsp3rnuzjqhnnscyg4u%20(1).png",
    "width": "300",
    "height": "100"
  },
  "contactPoint": {
    "@type": "ContactPoint",
    "telephone": "+52-442-141-5727",
    "contactType": "ventas",
    "email": "ventas@bellandsons.com.mx",
    "availableLanguage": ["Spanish", "English"]
  },
  "address": {
    "@type": "PostalAddress",
    "streetAddress": "Calle Principal 123",
    "addressLocality": "Querétaro",
    "addressRegion": "Querétaro",
    "postalCode": "76230",
    "addressCountry": "MX"
  },
  "sameAs": [
    "https://www.facebook.com/BellAndSonsMX",
    "https://www.instagram.com/bellandsons_mx",
    "https://wa.me/5214421415727"
  ]
};

const localBusiness = {
  "@type": "LocalBusiness",
  "@id": "https://bellandsons.com.mx/#localbusiness",
  "name": "Bell & Sons Querétaro",
  "description": "Especialistas en revestimientos WPC, pisos SPC y Culture Stone en Querétaro",
  "address": {
    "@type": "PostalAddress",
    "addressLocality": "Querétaro",
    "addressRegion": "Querétaro",
    "addressCountry": "MX"
  },
  "telephone": "+52-442-141-5727",
  "areaServed": {
    "@type": "AdministrativeArea",
    "name": "Querétaro"
  }
};

let jsonLdData: any = null;

if (type === 'article' && article) {
  const imageUrl = typeof article.image === 'string' 
    ? article.image.startsWith('http') 
      ? article.image 
      : `https://bellandsons.com.mx${article.image}`
    : `https://bellandsons.com.mx${article.image}`;

  jsonLdData = {
    "@context": "https://schema.org",
    "@graph": [
      organization,
      localBusiness,
      {
        "@type": "BlogPosting",
        "@id": `${article.url}#article`,
        "mainEntityOfPage": article.url,
        "headline": article.title,
        "description": article.description,
        "image": imageUrl,
        "author": {
          "@type": "Person",
          "name": article.author
        },
        "publisher": {
          "@id": "https://bellandsons.com.mx/#organization"
        },
        "datePublished": article.pubDate.toISOString(),
        "dateModified": article.pubDate.toISOString(),
        "inLanguage": "es-MX"
      },
      {
        "@type": "BreadcrumbList",
        "@id": `${article.url}#breadcrumb`,
        "itemListElement": [
          {
            "@type": "ListItem",
            "position": 1,
            "name": "Inicio",
            "item": "https://bellandsons.com.mx/"
          },
          {
            "@type": "ListItem",
            "position": 2,
            "name": "Blog",
            "item": "https://bellandsons.com.mx/blog/"
          },
          {
            "@type": "ListItem",
            "position": 3,
            "name": article.title
          }
        ]
      }
    ]
  };
} else if (type === 'website') {
  jsonLdData = {
    "@context": "https://schema.org",
    "@graph": [organization, localBusiness]
  };
}
---

{jsonLdData && (
  <script type="application/ld+json" set:html={JSON.stringify(jsonLdData)} />
)}
